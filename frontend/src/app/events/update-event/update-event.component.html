<div class="row">
  <div  class="col-md-3">
    <app-vnavbar></app-vnavbar>
  </div>

  <main role="main" class="col-md-6">
    <div class="col-md-12" style="margin:0 auto">

      <h2>Edit Event</h2>
      <br>
      <form [formGroup]="eventDTOForm" (ngSubmit)="update(eventDTOForm.value)">
        <!--  novalidate [hidden]="!canEdit"-->
        <form [formGroup]="eventForm">
          <div class="form-group">
            <div class="form-group">
              <label>Title</label>
              <input value="{{eventDTO.event.name}}" formControlName="name" id="name" type="text" class="form-control"
                     name="name" required/>
            </div>
            <div class="form-group">
              <label>Description</label>
              <editor initialValue="{{eventDTO.event.description}}" [formControlName]='["description"]' apiKey="h4g5a6vds8edp6kti3ahmikjin0r9usoqh99fs5l8xymelf5" [init]="{plugins: 'link'}"></editor>
            </div>
          </div>
          <br>
          <div class="form-group">
            <div class="form-group">
              <label>Start time</label>
              <input
                value="{{eventDTO.event.startTime | slice : 0 : 4}}-{{eventDTO.event.startTime | slice : 5 : 7}}-{{eventDTO.event.startTime |slice : 8 : 10}}T{{eventDTO.event.startTime | slice : 11 : 16}}"
                formControlName="startTime"
                type="datetime-local"
                class="form-control"
                name="startTime"/>
            </div>
            <div class="form-group">
              <label>End time</label>
              <input
                value="{{eventDTO.event.endTime | slice : 0 : 4}}-{{eventDTO.event.endTime | slice : 5 : 7}}-{{eventDTO.event.endTime |slice : 8 : 10}}T{{eventDTO.event.endTime | slice : 11 : 16}}"
                formControlName="endTime"
                type="datetime-local"
                class="form-control"
                name="endTime"/>
            </div>
          </div>
          <div *ngIf="(eventDTO.event.visibility == 'PUBLIC')" class="form-group">
            <label>Invite people</label>
            <div class="row">
              <div class="col-md-1"></div>
              <input class="form-control col-md-9" #manLogin id="people" type="text"
                     name="people"/>
              <button class="col-md-2" type="button" class="btn btn-primary" (click)="addUserToEvent(manLogin.value)">+</button>
            </div>
          </div>
        </form>
        <br>
        <form [formGroup]="additionEventForm">
          <table *ngIf="(eventDTO.event.visibility == 'PUBLIC')" class="table table-striped" style="overflow-x: auto; display: block;">
            <thead>
            <tr>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let login of people">
              <td>{{login}}</td>
              <td>
                <button type="button" class="btn btn-primary" (click)="deleteUserFromEvent(login)">remove</button>
              </td>
            </tr>
            </tbody>
          </table>
          <div class="form-group">
            <div class="form-group">
              <label>Priority</label>
              <select  value = {{eventDTO.additionEvent.priority}} formControlName="priority" id="priority" type="text" class="form-control" name="priority" required>
                <option value="LOW">Low</option>
                <option value="AVERAGE">Average</option>
                <option value="HIGH">High</option>
              </select>
            </div>
          </div>
        </form>
        <br>
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Update</button>
          <a [routerLink]="['../home']" class="btn btn-link">Cancel</a>
        </div>
      </form>

    </div>

  </main>

</div>

