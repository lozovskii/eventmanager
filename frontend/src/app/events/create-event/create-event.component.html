<script src="../update-event/update-event.component.ts"></script>
<div class="row">
  <div class="col-md-3">
    <app-vnavbar></app-vnavbar>
  </div>

  <main role="main" class="col-md-6">
    <h2>Create Event</h2>
    <br>
    <form [formGroup]="eventDTOForm">

      <form [formGroup]="eventForm">
        <div class="form-group">
          <label>Title</label>
          <input formControlName="name" type="text" class="form-control" required/>

          <div *ngIf="name.invalid && (name.dirty || name.touched)"
               class="alert alert-danger">

            <div *ngIf="name?.errors?.required">
              Title is required.
            </div>
            <div *ngIf="name?.errors?.minlength">
              Title must be at least 3 characters long.
            </div>
            <div *ngIf="name?.errors?.maxlength">
              Title must be less than 20 characters long.
            </div>
          </div>
        </div>
        <div class="form-group">
          <label>Description</label>
          <editor [formControlName]='["description"]' apiKey="h4g5a6vds8edp6kti3ahmikjin0r9usoqh99fs5l8xymelf5"  [init]="{plugins: 'link'}"></editor>
        </div>
        <br>
        <div class="form-group">
          <label>Day: </label>
          <input type="date" formControlName="day" class="dateTimeInput">
        </div>
        <div class="form-group">
          <label>Start time</label>
          <input formControlName="startTime" type="time" class="form-control"/>
        </div>
        <div class="form-group">
          <label>End time</label>
          <input formControlName="endTime" type="time" class="form-control"/>
        </div>
        <br>
        <div class="form-group">
          <label>Visibility</label>
          <select formControlName="visibility" [(ngModel)]="visibility" type="text" class="form-control"
                  name="visibility">
            <option *ngFor="let vision of visibilityList" [ngValue]="vision">
              {{vision}}
            </option>
          </select>
        </div>
        <div *ngIf="(visibility == 'PUBLIC')" class="form-group">
          <label>Invite people</label>
          <div class="row">
            <div class="col-md-1"></div>
            <input class="form-control col-md-9" #manLogin id="people" type="text"
                   name="people"/>
            <button class="col-md-2" type="button" class="btn btn-primary" (click)="addUserToEvent(manLogin.value)">+</button>
          </div>
        </div>
      </form>

      <form [formGroup]="additionEventForm">
        <table *ngIf="(visibility == 'PUBLIC')" class="table table-striped" style="overflow-x: auto; display: block;">
          <thead>
          <tr>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let login of selectedPeople">
            <td>{{login}}</td>
            <td>
              <button type="button" class="btn btn-primary" (click)="deleteUserFromEvent(login)">remove</button>
            </td>
          </tr>
          </tbody>
        </table>
        <div class="form-group">
          <label>Priority</label>
          <select formControlName="priority" type="text" class="form-control">
            <option value="LOW">Low</option>
            <option value="AVERAGE">Average</option>
            <option value="HIGH">High</option>
          </select>
        </div>
        <div class="form-group">
          <label>Frequency: </label>
          <input formControlName="frequencyNumber" type="number" class="form-control"/>
          <select formControlName="frequencyPeriod" type="text" class="form-control">
            <option value="day">day</option>
            <option value="week">week</option>
            <option value="month">month</option>
            <option value="year">year</option>
          </select>
          <div *ngIf="frequencyNumber.value!=null && frequencyNumber.invalid && (frequencyNumber.dirty || frequencyNumber.touched)"
               class="alert alert-danger">

            <div *ngIf="frequencyNumber?.errors?.min">
              Frequency number cannot be negative.
            </div>
          </div>
        </div>
      </form>
      <br>

      <div class="form-group">
        <button class="btn btn-primary" (click)="createEventForm(eventDTOForm.value)">Create</button>
        <button class="btn btn-primary" (click)="saveAsADraft(eventDTOForm.value)">Draft</button>
        <a [routerLink]="['../home']" class="btn btn-link">Cancel</a>
      </div>
    </form>
  </main>

</div>
